
<!DOCTYPE html>
<html lang="zh-Hans">
  <head>
    <!--[if lte IE 8]>
      <script type="text/javascript">
        var tags = ['header', 'footer', 'nav', 'aside', 'article', 'section', 'object', 'main'];
        for (var i in tags) {
          document.createElement(tags[i]);
        }
      </script>
    <![endif]-->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JavaScript 对象</title>
    <!-- font -->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" />
    <!-- js -->
    <script type="text/javascript" src="/js/jquery-3.3.1.min.js"></script>
    <!-- css -->
    <link rel="stylesheet" href="/css/reset.css" />
    <link rel="stylesheet" href="/css/icon.css" />
    <link rel="stylesheet" href="/katex/katex.min.css" />
     
    <link rel="stylesheet" href="/css/index.css" />
     
  <meta name="generator" content="Hexo 5.4.1"></head>

  <body>
    <!-- header -->
    <header class="header">
  <div class="logo">
    <!-- logo -->
    <div class="logo-wrap">
      <a href="/" id="logo"></a>
    </div>
  </div>
  <nav class="nav" id="top-nav">
    <ul>
      
        <li>
          <a class="" href="/">主页</a>
        </li>
      
        <li>
          <a class="" href="/categories">分类</a>
        </li>
      
        <li>
          <a class="" href="/tags">标签</a>
        </li>
      
        <li>
          <a class="" href="/archives">归档</a>
        </li>
      
      <!-- search -->
      
    </ul>
  </nav>
</header>


  
    <!-- main -->
    <main id="main" class="main">
      <!-- post -->

<div class="post show-toc">
  <!-- table of content -->
  
    <div class="post-toc">
      <div class="post-toc-content">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1"><span class="toc-text"> 创建对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F"><span class="toc-text"> 工厂模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%A8%A1%E5%BC%8F"><span class="toc-text"> 构造函数模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="toc-text"> 原型模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF"><span class="toc-text"> 继承</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#objectcreate"><span class="toc-text"> Object.create()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%84%E7%94%9F%E5%BC%8F%E7%BB%A7%E6%89%BF"><span class="toc-text"> 寄生式继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E7%BB%A7%E6%89%BF"><span class="toc-text"> 组合继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%84%E7%94%9F%E7%BB%84%E5%90%88%E5%BC%8F%E7%BB%A7%E6%89%BF"><span class="toc-text"> 寄生组合式继承</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7"><span class="toc-text"> 属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7"><span class="toc-text"> 定义属性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#objectdefineproperty"><span class="toc-text"> Object.defineProperty()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E5%90%8D%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-text"> 属性名表达式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E5%B1%9E%E6%80%A7"><span class="toc-text"> 访问属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%8D%E5%8E%86%E5%B1%9E%E6%80%A7"><span class="toc-text"> 遍历属性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#for-in"><span class="toc-text"> for in</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#for-of"><span class="toc-text"> for of</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#objectkeys"><span class="toc-text"> Object.keys()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#objectgetownpropertynames"><span class="toc-text"> Object.getOwnPropertyNames()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#object%E5%AF%B9%E8%B1%A1%E6%96%B9%E6%B3%95"><span class="toc-text"> Object对象方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#getownpropertydescriptor"><span class="toc-text"> getOwnPropertyDescriptor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#preventextensions"><span class="toc-text"> preventExtensions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#seal"><span class="toc-text"> seal</span></a></li></ol></li></ol>
      </div>
    </div>
  
  <!-- table of content end-->
  <!-- article -->
  <div class="cell">
    <article class="article">
      <!-- title -->
      
          <h1  class="title">JavaScript 对象</h1> 
      
      <div class="post-meta">
        <!-- time -->
        
          <span class="icon-baseline-query_builder-24px"></span>
          <time datetime="2018-04-08T06:49:00.000Z">
            2018-04-08
          </time>
        
        <!-- categories -->
        <!--
          <span class="icon-baseline-work_outline-24px"></span>
          
            <a href="/categories/JavaScript/">
              <span>JavaScript</span>
            </a>
          
        -->
        <!-- categories end -->
        <!-- tag -->
        <span class="icon-baseline-subtitles-24px"></span>
        
          <a href="/tags/JavaScript/">
            <span>JavaScript</span>
          </a>
        
      </div>
      <!-- content -->
      <div class="article-content">
      <p>JavaScript是一门面向对象的语言(Object Oriented,简称OO)<br />
什么是对象?对象是一组无序属性的集合</p>
<p>在JavaScript中,一切都是对象?不对,除了6类基本类型外都是对象<br />
Js有两大数据类型,基本类型和引用类型<br />
基本类型是保存在栈内存中的简单数据,有String Number Boolean null undefined Symbol,按值访问<br />
引用类型是保存在堆内存中的对象,有Object Array Function Date等,按引用访问</p>
<p>基本类型不是对象,那为什么他们有属性?<br />
调用基本类型的属性时,会临时创建一个对象,调用对象属性,然后销毁对象.下次调用属性时,再创建一个新的对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&#x27;lalala&#x27;</span>;</span><br><span class="line">str.<span class="title function_">valueOf</span>();</span><br><span class="line"><span class="comment">// 相当于</span></span><br><span class="line"><span class="keyword">var</span> temp = <span class="keyword">new</span> <span class="title class_">String</span>(str);</span><br><span class="line">temp.<span class="title function_">valueOf</span>(); <span class="comment">// &quot;lalala&quot;</span></span><br><span class="line">temp = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>
<p>因此不能给基本类型添加属性.完成操作后,新创建的对象被销毁了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str.<span class="property">t</span> = <span class="number">1</span>;</span><br><span class="line">str.<span class="property">t</span> <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
<p>注 typeof对null返回&quot;object&quot;是个bug<br />
<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/typeof">参考</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> <span class="literal">null</span> <span class="comment">// &quot;object&quot;</span></span><br></pre></td></tr></table></figure>
<span id="more"></span>
<h2 id="创建对象"><a class="markdownIt-Anchor" href="#创建对象"></a> 创建对象</h2>
<h3 id="工厂模式"><a class="markdownIt-Anchor" href="#工厂模式"></a> 工厂模式</h3>
<p>缺点:</p>
<ul>
<li>全部由Object构造函数生成,无法识别实例的对象类型</li>
<li>无法判断实例方法是否相等</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age</span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">name</span>: name,</span><br><span class="line">      <span class="attr">age</span>: <span class="built_in">parseInt</span>(age),</span><br><span class="line">      <span class="attr">getName</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="title class_">Person</span>(<span class="string">&#x27;anna&#x27;</span>, <span class="number">14.4</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p.<span class="property">constructor</span> ); <span class="comment">// Object()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="title class_">Person</span>(<span class="string">&#x27;bob&#x27;</span>, <span class="number">20</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p.<span class="property">getName</span> === p1.<span class="property">getName</span> ); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="构造函数模式"><a class="markdownIt-Anchor" href="#构造函数模式"></a> 构造函数模式</h3>
<p>缺点:</p>
<ul>
<li>无法判断实例方法是否相等</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age</span>)&#123;</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">age</span> = <span class="built_in">parseInt</span>(age);</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">getName</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;anna&#x27;</span>, <span class="number">14.4</span>);</span><br></pre></td></tr></table></figure>
<p>构造函数模式解决了识别对象类型的问题,可使用instanceof判断p是否是Person的实例</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p <span class="keyword">instanceof</span> <span class="title class_">Person</span> ); <span class="comment">// ture</span></span><br></pre></td></tr></table></figure>
<p>每个实例都有一个constructor属性,指回构造函数(实例是调用构造函数返回的对象)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p.<span class="property">constructor</span> ) <span class="comment">// function Person &#123;&#125;...</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( .<span class="property">constructor</span> === <span class="title class_">Person</span> ); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>但构造函数仍然无法判断实例的同名方法是否相等</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 每个实例都把方法重新创建一遍,导致实例上的同名函数不等</span></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;bob&#x27;</span>, <span class="number">16</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p.<span class="property">getName</span> === p1.<span class="property">getName</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="原型模式"><a class="markdownIt-Anchor" href="#原型模式"></a> 原型模式</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>)&#123; &#125;</span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">name</span> = <span class="string">&#x27;anna&#x27;</span>;</span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br></pre></td></tr></table></figure>
<p>什么是prototype?<br />
在创建函数时,会自动生成一个对象,可通过函数的prototype属性访问这个对象,因此称其为&quot;原型对象&quot;.这个对象包含一个constructor属性,指回函数.<br />
构造函数生成的实例可以访问绑定在prototype上的属性和方法</p>
<p>JS的创造者为什么要设计prototype?<br />
单纯的使用构造函数生成的对象无法共享属性/方法,为了解决这个问题,引入了原型链(prototype)的概念.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">age</span> = <span class="number">14</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p.<span class="property">age</span> ); <span class="comment">// 14</span></span><br></pre></td></tr></table></figure>
<p>实例的constructor属性也继承自prototype</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> === <span class="title class_">Person</span> ); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;constructor&#x27;</span>)) <span class="comment">// false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;constructor&#x27;</span>) ) <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p.<span class="property">constructor</span> === <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> ) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>每个实例都有一个内部属性([[prototype]]),指向构造函数的原型对象,非ie浏览器可用__proto__访问这个原型对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c (p.<span class="property">__proto__</span> === <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> ); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p.<span class="property">constructor</span>.<span class="property"><span class="keyword">prototype</span></span> === p.<span class="property">__proto__</span> ); <span class="comment">// true </span></span><br></pre></td></tr></table></figure>
<p>除了__proto__,还可以用Object.getPrototypeOf()访问构造函数的原型对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(p) === <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> ); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>可使用prototype.isPrototypeOf或instanceof判断一个对象是否在另一个对象的原型链中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">isPrototypeOf</span>(p) ); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p <span class="keyword">instanceof</span> <span class="title class_">Person</span> ); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>可使用in关键字判断一个属性是否在实例上/实例的原型链中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="string">&#x27;name&#x27;</span> <span class="keyword">in</span> p ); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>注意 不能通过实例直接修改/删除prototype中的属性值<br />
向实例对象添加属性时,该属性会被添加在实例对象上,而非修改原型对象中的同名属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">p1.<span class="property">name</span> = <span class="string">&#x27;bob&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p1.<span class="property">name</span> ); <span class="comment">// bob </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p.<span class="property">name</span> ); <span class="comment">// anna </span></span><br><span class="line"><span class="comment">// 删除的是绑定在实例上的属性name,而非原型上的属性name</span></span><br><span class="line"><span class="keyword">delete</span> p1.<span class="property">name</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p1.<span class="property">name</span> ); <span class="comment">// anna </span></span><br></pre></td></tr></table></figure>
<p>但如果绑在prototype上的属性是引用类型(对象),可以用push之类的操作直接修改的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">like</span> = [<span class="string">&#x27;milk&#x27;</span>, <span class="string">&#x27;fish&#x27;</span>]</span><br><span class="line">p1.<span class="property">like</span>.<span class="title function_">push</span>(<span class="string">&#x27;banana&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p1.<span class="property">like</span> ); <span class="comment">// milk,fish,banana </span></span><br></pre></td></tr></table></figure>
<p>prototype本质上来说是个对象,因此可直接重写<br />
不过这会把contructror指向Object,可通过将constructor指向Person来修复这个问题</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;lan&#x27;</span>,</span><br><span class="line">   <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">   <span class="attr">constructor</span>: <span class="title class_">Person</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实例的内置属性[[prototype]]是个指针,指向原型对象(而非构造函数)  </span></span><br><span class="line"><span class="comment">// 给prototype赋值一个新对象只是把这个指针指向这个新对象,原来的那个原型对象并未被修改</span></span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p2.<span class="property">name</span> ); <span class="comment">// lan</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(p2) ); <span class="comment">// &#123;&quot;name&quot;:&quot;lan&quot;,&quot;age&quot;:20&#125;</span></span><br><span class="line"><span class="comment">// 实例p的原型链还是指向原来的那个原型对象</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p.<span class="property">name</span> ); <span class="comment">// anna</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(p1) ); <span class="comment">// &#123;&quot;name&quot;:&quot;anna&quot;,&quot;age&quot;:14,&quot;like&quot;:[&quot;milk&quot;,&quot;fish&quot;,&quot;banana&quot;]&#125;</span></span><br></pre></td></tr></table></figure>
<p>为了避免绑定在prototype上的引用类型被修改,一般混合使用构造函数模式和原型链模式.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age, like</span>)&#123;</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">like</span> = like;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getlike</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">like</span>.<span class="title function_">join</span>(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;anna&#x27;</span>, <span class="number">14</span>, [<span class="string">&#x27;banana&#x27;</span>]);</span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;anna&#x27;</span>, <span class="number">14</span>, [<span class="string">&#x27;apple&#x27;</span>]);</span><br><span class="line">p.<span class="property">like</span>.<span class="title function_">push</span>(<span class="string">&#x27;pineapple&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p.<span class="title function_">getlike</span>() );</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p1.<span class="title function_">getlike</span>() );</span><br></pre></td></tr></table></figure>
<h2 id="继承"><a class="markdownIt-Anchor" href="#继承"></a> 继承</h2>
<p>让一个对象继承另一个对象的所有属性</p>
<h3 id="objectcreate"><a class="markdownIt-Anchor" href="#objectcreate"></a> Object.create()</h3>
<p>Object.create接收两个参数,新对象的原型和需新添加的属性(可选)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;anna&#x27;</span>,</span><br><span class="line">    <span class="attr">like</span>: [<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;cake&#x27;</span>],</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> p1 = <span class="title class_">Object</span>.<span class="title function_">create</span>(p, &#123;</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: <span class="string">&#x27;bob&#x27;</span>,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p.<span class="property">name</span> ); <span class="comment">// &quot;anna&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p1.<span class="property">name</span> ); <span class="comment">// &quot;bob&quot;</span></span><br><span class="line"></span><br><span class="line">p1.<span class="property">like</span>.<span class="title function_">push</span>(<span class="string">&#x27;banana&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p.<span class="property">like</span> ); <span class="comment">//  [&quot;apple&quot;, &quot;cake&quot;, &quot;banana&quot;]</span></span><br></pre></td></tr></table></figure>
<p>Object.create本质上类似原型式继承</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;anna&#x27;</span>,</span><br><span class="line">    <span class="attr">like</span>: [<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;cake&#x27;</span>],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createObject</span>(<span class="params">parent</span>) &#123;</span><br><span class="line">    <span class="comment">// 创建一个临时构造函数,把prototype指向parent</span></span><br><span class="line">    <span class="keyword">var</span> f = <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;;</span><br><span class="line">    f.<span class="property"><span class="keyword">prototype</span></span> = parent;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">f</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="title function_">createObject</span>(p);</span><br><span class="line">p1.<span class="property">name</span> <span class="comment">// &quot;anna&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p1.<span class="property">__proto__</span> === p ); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>原型式继承的缺点: 无法向原型传递参数,对象中的引用类型会被所有实例共享</p>
<h3 id="寄生式继承"><a class="markdownIt-Anchor" href="#寄生式继承"></a> 寄生式继承</h3>
<p>寄生式继承是原型式继承的扩展,在继承原对象属性的同时,添加新的属性<br />
缺点: 无法向原型传递参数, 无法复用属性和方法,对象中的引用类型会被所有实例共享</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;anna&#x27;</span>,</span><br><span class="line">    <span class="attr">like</span>: [<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;cake&#x27;</span>],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createObject</span>(<span class="params">parent</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> f = <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;;</span><br><span class="line">    f.<span class="property"><span class="keyword">prototype</span></span> = parent;</span><br><span class="line">    <span class="keyword">var</span> clone = <span class="keyword">new</span> <span class="title function_">f</span>();</span><br><span class="line">    <span class="comment">// 到这里和组合继承一样</span></span><br><span class="line">    clone.<span class="property">getName</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> clone;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p1 = <span class="title function_">createObject</span>(p);</span><br><span class="line"><span class="keyword">var</span> p2 = <span class="title function_">createObject</span>(p);</span><br><span class="line"></span><br><span class="line">p1.<span class="property">name</span> = <span class="string">&#x27;bob&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( p1.<span class="title function_">getName</span>() ); <span class="comment">// &quot;bob&quot;</span></span><br><span class="line"></span><br><span class="line">p1.<span class="property">like</span>.<span class="title function_">push</span>(<span class="string">&#x27;banana&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="property">like</span>); <span class="comment">//  [&quot;apple&quot;, &quot;cake&quot;, &quot;banana&quot;]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p2.<span class="property">like</span>); <span class="comment">// [&quot;apple&quot;, &quot;cake&quot;, &quot;banana&quot;]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="组合继承"><a class="markdownIt-Anchor" href="#组合继承"></a> 组合继承</h3>
<p>使用prototype和构造函数实现继承,解决了属性复用的问题,避免引用类型被实例共享<br />
缺点: 需生成两份原型属性拷贝</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">SuperType</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">colors</span> = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">getColor</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">colors</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">SuperType</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayName</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SubType</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">    <span class="comment">// 通过call调用SuperType, 把this指向SubType</span></span><br><span class="line">    <span class="title class_">SuperType</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name);</span><br><span class="line">    <span class="comment">// 添加私有属性age</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 将subType的原型链指向SuperType的实例</span></span><br><span class="line"><span class="comment">// 又执行了一次SuperType,导致最终有两份SuperType的属性拷贝</span></span><br><span class="line"><span class="title class_">SubType</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">SuperType</span>();</span><br><span class="line"><span class="title class_">SubType</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayAge</span>= <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">age</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 修复constructor指向</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="title class_">SubType</span>.<span class="property"><span class="keyword">prototype</span></span>, <span class="string">&#x27;constructor&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">value</span>: <span class="title class_">SubType</span>,</span><br><span class="line">    <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">configurable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">enumerable</span>: <span class="literal">false</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> child = <span class="keyword">new</span> <span class="title class_">SubType</span>(<span class="string">&#x27;bob&#x27;</span>, <span class="number">29</span>);</span><br><span class="line"><span class="keyword">var</span> child1 = <span class="keyword">new</span> <span class="title class_">SubType</span>(<span class="string">&#x27;tom&#x27;</span>, <span class="number">30</span>);</span><br><span class="line">child.<span class="title function_">sayAge</span>(); <span class="comment">// 29</span></span><br><span class="line">child.<span class="title function_">sayName</span>(); <span class="comment">// &#x27;bob&#x27;</span></span><br><span class="line">child1.<span class="title function_">sayAge</span>(); <span class="comment">// 30</span></span><br><span class="line">child1.<span class="title function_">sayName</span>(); <span class="comment">// &#x27;tom&#x27;</span></span><br><span class="line"></span><br><span class="line">child.<span class="property">colors</span>.<span class="title function_">push</span>(<span class="string">&#x27;orange&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( child.<span class="property">colors</span> ); <span class="comment">// [&quot;red&quot;, &quot;blue&quot;, &quot;orange&quot;]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( child1.<span class="property">colors</span> ); <span class="comment">//  [&quot;red&quot;, &quot;blue&quot;]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( child.<span class="property">getColor</span> === child1.<span class="property">getColor</span> )  <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( child.<span class="property">sayName</span> === child1.<span class="property">sayName</span> ) <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( child.<span class="property">constructor</span> === child1.<span class="property">constructor</span> ) <span class="comment">// true</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="寄生组合式继承"><a class="markdownIt-Anchor" href="#寄生组合式继承"></a> 寄生组合式继承</h3>
<p>同时使用寄生继承和组合继承,避免多次调用构造函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createObject</span>(<span class="params">SuperTypePrototype</span>) &#123;</span><br><span class="line">    <span class="comment">// 创建临时构造函数</span></span><br><span class="line">    <span class="keyword">var</span> F = <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;;</span><br><span class="line">    <span class="comment">// 将F.prototype指向SuperType.prototype</span></span><br><span class="line">    F.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">SuperTypePrototype</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">F</span>(); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">inheritPrototype</span>(<span class="params">subType, superType</span>) &#123;</span><br><span class="line">    <span class="comment">// 创建原型对象</span></span><br><span class="line">    <span class="keyword">var</span> prototype = <span class="title function_">createObject</span>(superType.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line">    <span class="comment">// 修复constructor指向</span></span><br><span class="line">    prototype.<span class="property">constructor</span> = subType;</span><br><span class="line">    <span class="comment">// 将subType原型链指向新建的原型对象</span></span><br><span class="line">    subType.<span class="property"><span class="keyword">prototype</span></span> = prototype;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SuperType</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">colors</span> = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">SuperType</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayName</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SubType</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">    <span class="comment">// 继承构造函数里的属性</span></span><br><span class="line">    <span class="title class_">SuperType</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 继承原型链里的属性</span></span><br><span class="line"><span class="title function_">inheritPrototype</span>(<span class="title class_">SubType</span>, <span class="title class_">SuperType</span>);</span><br><span class="line"><span class="keyword">var</span> child = <span class="keyword">new</span> <span class="title class_">SubType</span>(<span class="string">&#x27;bob&#x27;</span>, <span class="number">29</span>);</span><br></pre></td></tr></table></figure>
<h2 id="属性"><a class="markdownIt-Anchor" href="#属性"></a> 属性</h2>
<p>什么是属性?属性就是个变量,指向内存中的某个值.</p>
<h3 id="定义属性"><a class="markdownIt-Anchor" href="#定义属性"></a> 定义属性</h3>
<p>Js有两种属性,数据属性和访问器属性</p>
<ul>
<li>数据属性: 具有值的属性,有以下键值: value writable enumerable configurable</li>
<li>访问器属性: 由getter/setter函数定义的属性,有以下键值: get set enumerable configurable</li>
</ul>
<h4 id="objectdefineproperty"><a class="markdownIt-Anchor" href="#objectdefineproperty"></a> Object.defineProperty()</h4>
<p>定义对象中新的属性,或修改已存在的属性<br />
Object.defineProperty(obj, prop, descriptor)</p>
<ul>
<li>obj 对象</li>
<li>prop属性名</li>
<li>descriptor 属性描述
<ul>
<li>value 属性值</li>
<li>writable 能否修改属性值</li>
<li>enumerable 能否通过for in和Object.keys获取属性</li>
<li>configurable 能否更改/删除属性</li>
<li>get getter方法,返回属性值,默认值为undefined</li>
<li>set 属性的setter方法,用于设置属性值,默认值为undefined</li>
</ul>
</li>
</ul>
<p>注:</p>
<ul>
<li>writable enumerable configurable 的默认值皆为false</li>
<li>get不接受参数</li>
</ul>
<p>当configurable为false时,仍可将writable: true改为false(反过来不行)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;&#125;;</span><br><span class="line">// 定义一个可修改值(writable: true),不可设置的属性(configurable: false)</span><br><span class="line">Object.defineProperty(obj, &#x27;say&#x27;, &#123;</span><br><span class="line">    value: &#x27;hello&#x27;,</span><br><span class="line">    writable: true,</span><br><span class="line">    configurable: false,</span><br><span class="line">&#125;) </span><br><span class="line">obj.say = &#x27;hi&#x27;</span><br><span class="line">obj.say // &quot;hi&quot;</span><br><span class="line">// 更改writable为false</span><br><span class="line">Object.defineProperty(obj, &#x27;say&#x27;, &#123;</span><br><span class="line">    value: &#x27;hello&#x27;,</span><br><span class="line">    writable: false,</span><br><span class="line">    configurable: false,</span><br><span class="line">&#125;) // &#123;say: &quot;hello&quot;&#125;</span><br><span class="line">obj.say = &#x27;lll&#x27;</span><br><span class="line">obj.say // &quot;hello&quot;</span><br><span class="line">// 再改回去,报错</span><br><span class="line">Object.defineProperty(obj, &#x27;say&#x27;, &#123;</span><br><span class="line">    value: &#x27;hello&#x27;,</span><br><span class="line">    writable: true,</span><br><span class="line">    configurable: false,</span><br><span class="line">&#125;) </span><br><span class="line">// TypeError: Cannot redefine property: say</span><br></pre></td></tr></table></figure>
<p>当writable为false时,无法修改属性值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;&#125;;</span><br><span class="line">Object.defineProperty(obj, &#x27;say&#x27;, &#123;</span><br><span class="line">    value: &#x27;hello&#x27;,</span><br><span class="line">    writable: false, // 禁止修改属性值</span><br><span class="line">    configurable: true,</span><br><span class="line">&#125;) </span><br><span class="line">// &#123;say: &quot;hello&quot;&#125;</span><br><span class="line">obj.say = &#x27;hi&#x27;;</span><br><span class="line">// 尝试修改属性say,但还是&quot;hello&quot;</span><br><span class="line">// 如果是&#x27;use strict&#x27;模式, 会报错TypeError: &quot;say&quot; is read-only  </span><br><span class="line">obj.say // &quot;hello&quot;;</span><br></pre></td></tr></table></figure>
<p>例 定义访问器属性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">obj = &#123;_a: 1&#125;;</span><br><span class="line">Object.defineProperty(obj, &#x27;say&#x27;, &#123;</span><br><span class="line">    get: function()&#123;</span><br><span class="line">        return this._a;</span><br><span class="line">    &#125;,</span><br><span class="line">    set: function(value)&#123;</span><br><span class="line">        this._a = value;</span><br><span class="line">    &#125;,</span><br><span class="line">    enumerable: true,</span><br><span class="line">    configurable: true,</span><br><span class="line">&#125;)</span><br><span class="line">obj.say // 1</span><br><span class="line">obj.say = 2</span><br><span class="line">obj.say // 2</span><br></pre></td></tr></table></figure>
<p>还可以通过get和set关键字创建访问器属性</p>
<!-- get和set是绑定在属性上的隐藏函数,分别在查找属性/修改属性时调用   -->
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// 计数器</span><br><span class="line">var c = &#123;</span><br><span class="line">    _index_: 0,</span><br><span class="line">    set index(i) &#123;</span><br><span class="line">        this._index_ = i;</span><br><span class="line">    &#125;,</span><br><span class="line">    get index() &#123;</span><br><span class="line">        // 获取值时自动加一</span><br><span class="line">        return ++this._index_;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c.index = 1;</span><br><span class="line">c.index; // 2</span><br><span class="line">c.index; // 3</span><br><span class="line">c.index; // 4</span><br></pre></td></tr></table></figure>
<h4 id="属性名表达式"><a class="markdownIt-Anchor" href="#属性名表达式"></a> 属性名表达式</h4>
<p>Es6允许使用表达式定义属性名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 将表达式放在中括号内  </span><br><span class="line">var obj = &#123;[&quot;s&quot; + &quot;ay&quot;]: &quot;hello world&quot;&#125;;</span><br><span class="line">obj // &#123;say: &quot;hello world&quot;&#125;</span><br></pre></td></tr></table></figure>
<p>如果属性名是对象,会自动将其转为字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;[new Object()]: &quot;hello world&quot;&#125;</span><br><span class="line">obj[&quot;[object Object]&quot;] // &quot;hello world&quot;</span><br></pre></td></tr></table></figure>
<h3 id="访问属性"><a class="markdownIt-Anchor" href="#访问属性"></a> 访问属性</h3>
<p>有两种方式访问属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">say</span>: <span class="string">&quot;hello world&quot;</span>&#125;</span><br><span class="line"><span class="comment">// 属性访问</span></span><br><span class="line">obj.<span class="property">say</span> <span class="comment">// &quot;hello world&quot;</span></span><br><span class="line"><span class="comment">// 键访问</span></span><br><span class="line">obj[<span class="string">&quot;say&quot;</span>] <span class="comment">// &quot;hello world&quot;</span></span><br></pre></td></tr></table></figure>
<p>当属性名中包含空格等特殊字符时,只能用第二种方式获取属性值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;<span class="string">&quot;s-ay&quot;</span>: <span class="string">&quot;hello world&quot;</span>&#125;</span><br><span class="line">obj.<span class="property">s</span>-ay <span class="comment">// ReferenceError: ay is not defined</span></span><br><span class="line">obj[<span class="string">&quot;s-ay&quot;</span>] <span class="comment">// &quot;hello world&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="遍历属性"><a class="markdownIt-Anchor" href="#遍历属性"></a> 遍历属性</h3>
<h4 id="for-in"><a class="markdownIt-Anchor" href="#for-in"></a> for in</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="attr">index</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;anna&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i); <span class="comment">// index name</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj[i]); <span class="comment">// 1 anna</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>for in会向上遍历原型链(prototype),可用hasOwnProperty方法判断该属性是否来自自身.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改Object的原型链,添加属性color</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">color</span> = <span class="string">&#x27;#fff&#x27;</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="comment">// color 被遍历出来了</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i); <span class="comment">// index name color</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj[i]); <span class="comment">// 1 anna #fff</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用hasOwnProperty过滤继承自原型的属性</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj.<span class="title function_">hasOwnProperty</span>(i)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(i); <span class="comment">// index name   </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="for-of"><a class="markdownIt-Anchor" href="#for-of"></a> for of</h4>
<p>es6新增, 一般用来遍历数组和字符串</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">of</span> arr) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i) <span class="comment">// a b c</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> arr) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i) <span class="comment">// 0 1 2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>for in遍历的是对象的可枚举属性,返回属性名.而for of会尝试获取对象的迭代器,使用迭代器遍历属性值.<br />
因此for of不会遍历原型链上的属性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var arr = [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;];</span><br><span class="line">Object.prototype.color = &#x27;#fff&#x27;;</span><br><span class="line">for (var i of arr) &#123;</span><br><span class="line">    console.log(i) // a b c</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>数组和字符串自带迭代器.如果想对普通对象使用for of,需声明迭代器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;</span><br><span class="line">    index1: &#x27;a&#x27;,</span><br><span class="line">    index2: &#x27;b&#x27;,</span><br><span class="line">    // Symbol,Es6新增对象,可用Symbol.iterator声明对象迭代器</span><br><span class="line">    [Symbol.iterator]() &#123;</span><br><span class="line">        var _this = this;</span><br><span class="line">        var keys = Object.keys(this);</span><br><span class="line">        var i = 0;</span><br><span class="line">        // 返回迭代器,包含一个next方法</span><br><span class="line">        // next方法有两个属性,value和done</span><br><span class="line">        // value为返回值(在这里返回的是obj的属性值)</span><br><span class="line">        // 当done为true时,迭代结束</span><br><span class="line">        return &#123;</span><br><span class="line">            next() &#123;</span><br><span class="line">                var v = _this[keys[i]];</span><br><span class="line">                i++;</span><br><span class="line">                return &#123;value: v, done: (i &gt; keys.length)&#125;  </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">for(var i of obj) &#123;</span><br><span class="line">    console.log(i);</span><br><span class="line">&#125; // a b</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="objectkeys"><a class="markdownIt-Anchor" href="#objectkeys"></a> Object.keys()</h4>
<p>返回对象的可枚举属性值(不含prototype)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;anna&#x27;</span>,</span><br><span class="line">    <span class="attr">index</span>: <span class="number">0</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">color</span> = <span class="string">&#x27;#fff&#x27;</span>;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(obj) <span class="comment">// [&quot;name&quot;, &quot;index&quot;]</span></span><br></pre></td></tr></table></figure>
<p>属性必须可枚举的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Object.defineProperty(obj, &#x27;say&#x27;, &#123;</span><br><span class="line">    enumeable: false,</span><br><span class="line">    value: &#x27;hi&#x27;</span><br><span class="line">&#125;)</span><br><span class="line">// 无法获取say,因为enumeable为false</span><br><span class="line">Object.keys(obj) // [&quot;name&quot;, &quot;index&quot;]</span><br></pre></td></tr></table></figure>
<h4 id="objectgetownpropertynames"><a class="markdownIt-Anchor" href="#objectgetownpropertynames"></a> Object.getOwnPropertyNames()</h4>
<p>获取对象的所有属性(无虑是否可枚举,不包括prototype和Symbol)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;anna&#x27;</span>,</span><br><span class="line">    <span class="attr">index</span>: <span class="number">0</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">color</span> = <span class="string">&#x27;#fff&#x27;</span>;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">getOwnPropertyNames</span>(obj); <span class="comment">// [&quot;name&quot;, &quot;index&quot;]</span></span><br></pre></td></tr></table></figure>
<h2 id="object对象方法"><a class="markdownIt-Anchor" href="#object对象方法"></a> Object对象方法</h2>
<h3 id="getownpropertydescriptor"><a class="markdownIt-Anchor" href="#getownpropertydescriptor"></a> getOwnPropertyDescriptor</h3>
<p>获取属性描述,用于判断属性是否可以修改/枚举</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;say: &#x27;hello&#x27;&#125;</span><br><span class="line">Object.getOwnPropertyDescriptor(obj, &#x27;say&#x27;)</span><br><span class="line">// &#123;value: &quot;hello&quot;, writable: true, enumerable: true, configurable: true&#125;</span><br></pre></td></tr></table></figure>
<h3 id="preventextensions"><a class="markdownIt-Anchor" href="#preventextensions"></a> preventExtensions</h3>
<p>禁止向对象添加新属性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;say: &#x27;hello&#x27;&#125;</span><br><span class="line">Object.preventExtensions(obj)</span><br><span class="line">obj.index = 1</span><br><span class="line">obj.index // undefined</span><br></pre></td></tr></table></figure>
<h3 id="seal"><a class="markdownIt-Anchor" href="#seal"></a> seal</h3>
<p>禁止向对象添加新属性,同时设置所有属性的configurable为false(禁止修改/删除)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;say: &#x27;hello&#x27;&#125;</span><br><span class="line">Object.seal(obj)</span><br><span class="line">obj.index = 1</span><br><span class="line">obj.index // undefined</span><br><span class="line">delete obj.say // false</span><br></pre></td></tr></table></figure>

      </div>
    </article>
  </div>
  <!-- pagination -->
  
    <nav class="pagination">
      
        <a class="prev" href="/article/javascript-function/">&lt;  JavaScipt function</a>
      
      
        <a class="next" href="/article/gulp/">gulp 4.0  &gt;</a>
      
    </nav>    
  
  <!-- pagination end -->
</div>






    </main>

    <!-- search -->
     
    
    <script src="/js/main.js"></script>
     
  </body>
</html>
